<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../../displayToc.js"></script>
<script language="JavaScript" src="../../../../tocParas.js"></script>
<script language="JavaScript" src="../../../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>CPAN::SQLite::META - helper module for CPAN.pm integration</p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This module has no direct public interface, but is intended as a helper module for use of CPAN::SQLite within the CPAN.pm module. A new object is created as</p>

<pre><code>  <span class="keyword">my</span> <span class="variable">$obj</span> <span class="operator">=</span> <span class="variable">CPAN::SQLite::META</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span><span class="variable">$CPAN::META</span><span class="operator">);</span>
</code></pre>

<p>where <code>$CPAN::META</code> comes from CPAN.pm. There are then two main methods available.</p>

<dl>

<dt id="set"><code>set</code></dt>
<dd>

<p>This is used as</p>

<pre><code>   <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">set</span><span class="operator">(</span><span class="variable">$class</span><span class="operator">,</span> <span class="variable">$id</span><span class="operator">);</span>
</code></pre>

<p>where <code>$class</code> is one of <code>CPAN::Author</code>, <code>CPAN::Module</code>, or <code>CPAN::Distribution</code>, and <code>$id</code> is the id CPAN.pm uses to identify the class. The method searches the <code>CPAN::SQLite</code> database by name using the appropriate <code>author</code>, <code>dist</code>, or <code>module</code> mode, and if a result is found, calls</p>

<pre><code>    <span class="variable">$CPAN::META</span><span class="operator">-&gt;</span><span class="variable">instance</span><span class="operator">(</span>
                         <span class="variable">$class</span> <span class="operator">=&gt;</span> <span class="variable">$id</span>
                         <span class="operator">)-&gt;</span><span class="variable">set</span><span class="operator">(</span>
                          <span class="variable">%attributes</span>
                         <span class="operator">);</span>
</code></pre>

<p>to register an instance of this class within <code>CPAN.pm</code>.</p>

</dd>
<dt id="ssearch"><code>ssearch</code></dt>
<dd>

<p>This is used as</p>

<pre><code>   <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">search</span><span class="operator">(</span><span class="variable">$class</span><span class="operator">,</span> <span class="variable">$id</span><span class="operator">);</span>
</code></pre>

<p>where <code>$class</code> is one of <code>CPAN::Author</code>, <code>CPAN::Module</code>, or <code>CPAN::Distribution</code>, and <code>$id</code> is the id CPAN.pm uses to identify the class. The method searches the <code>CPAN::SQLite</code> database by <code>query</code> using the appropriate <code>author</code>, <code>dist</code>, or <code>module</code> mode, and if results are found, calls</p>

<pre><code>    <span class="variable">$CPAN::META</span><span class="operator">-&gt;</span><span class="variable">instance</span><span class="operator">(</span>
                         <span class="variable">$class</span> <span class="operator">=&gt;</span> <span class="variable">$id</span>
                         <span class="operator">)-&gt;</span><span class="variable">set</span><span class="operator">(</span>
                          <span class="variable">%attributes</span>
                         <span class="operator">);</span>
</code></pre>

<p>for each match to register an instance of this class within <code>CPAN.pm</code>.</p>

</dd>
</dl>

<p>The attributes set within <code>$CPAN::META-</code>instance&gt; depend on the particular class.</p>

<dl>

<dt id="author">author</dt>
<dd>

<p>The attributes are</p>

<pre><code>       <span class="string">'FULLNAME'</span> <span class="operator">=&gt;</span> <span class="variable">$results</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">fullname</span><span class="operator">}</span><span class="operator">,</span>
       <span class="string">'EMAIL'</span> <span class="operator">=&gt;</span> <span class="variable">$results</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">email</span><span class="operator">}</span><span class="operator">,</span>
</code></pre>

<p>where <code>$results</code> are the results returned from <code>CPAN::SQLite</code>.</p>

</dd>
<dt id="module">module</dt>
<dd>

<p>The attributes are</p>

<pre><code>        <span class="string">'description'</span> <span class="operator">=&gt;</span> <span class="variable">$results</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">mod_abs</span><span class="operator">}</span><span class="operator">,</span>
        <span class="string">'userid'</span> <span class="operator">=&gt;</span> <span class="variable">$results</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">cpanid</span><span class="operator">}</span><span class="operator">,</span>
        <span class="string">'CPAN_VERSION'</span> <span class="operator">=&gt;</span> <span class="variable">$results</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">mod_vers</span><span class="operator">}</span><span class="operator">,</span>
        <span class="string">'CPAN_FILE'</span> <span class="operator">=&gt;</span> <span class="variable">$results</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">download</span><span class="operator">}</span><span class="operator">,</span>
        <span class="string">'CPAN_USERID'</span> <span class="operator">=&gt;</span> <span class="variable">$results</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">cpanid</span><span class="operator">}</span><span class="operator">,</span>
        <span class="string">'chapterid'</span> <span class="operator">=&gt;</span> <span class="variable">$results</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">chapterid</span><span class="operator">}</span><span class="operator">,</span>
        <span class="variable">%dslip</span><span class="operator">,</span>
</code></pre>

<p>where <code>$results</code> are the results returned from <code>CPAN::SQLite</code>. Here, <code>%dslip</code> is a hash containing keys <code>statd</code>, <code>stats</code>, <code>statl</code>, <code>stati</code>, and <code>statp</code>, with corresponding values being the registered dslip entries for the module, if present.</p>

</dd>
<dt id="dist">dist</dt>
<dd>

<p>The attributes are</p>

<pre><code>       <span class="string">'DESCRIPTION'</span> <span class="operator">=&gt;</span> <span class="variable">$results</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">dist_abs</span><span class="operator">}</span><span class="operator">,</span>
       <span class="string">'CPAN_USERID'</span> <span class="operator">=&gt;</span> <span class="variable">$results</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">cpanid</span><span class="operator">}</span><span class="operator">,</span>
       <span class="string">'CPAN_VERSION'</span> <span class="operator">=&gt;</span> <span class="variable">$results</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">dist_vers</span><span class="operator">}</span><span class="operator">,</span>
</code></pre>

<p>As well, a <code>CONTAINSMODS</code> key to <code>$CPAN::META</code> is added, this being a hash reference whose keys are the modules contained within the distribution.</p>

</dd>
</dl>

<p>There is also a method available <code>reload</code>, which rebuilds the database. It can be used as</p>

<pre><code>   <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">reload</span><span class="operator">(</span><span class="string">force</span> <span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">,</span> <span class="string">time</span> <span class="operator">=&gt;</span> <span class="variable">$time</span><span class="operator">);</span>
</code></pre>

<p>The <code>time</code> option (which, if not passed in, will default to the current time) will be used to compare the current time to the mtime of the database file; if they differ by more than one day, the database will be rebuilt. The &lt;force&gt; option, if given, will force a rebuilding of the database regardless of the time difference.</p>


</body>

</html>


