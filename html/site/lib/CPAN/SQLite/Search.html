<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../../displayToc.js"></script>
<script language="JavaScript" src="../../../../tocParas.js"></script>
<script language="JavaScript" src="../../../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#CONSTRUCTING-THE-QUERY">CONSTRUCTING THE QUERY</a>
    <ul>
      <li><a href="#module-dist-and-author-modes"><code>module</code>, <code>dist</code>, and <code>author</code> modes</a></li>
    </ul>
  </li>
  <li><a href="#RESULTS">RESULTS</a>
    <ul>
      <li><a href="#author-mode"><code>author</code> mode</a></li>
      <li><a href="#module-mode"><code>module</code> mode</a></li>
      <li><a href="#dist-mode"><code>dist</code> mode</a></li>
    </ul>
  </li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
  <li><a href="#AUTHORS">AUTHORS</a></li>
  <li><a href="#COPYRIGHT">COPYRIGHT</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>CPAN::SQLite::Search - perform queries on the database</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code>  <span class="keyword">my</span> <span class="variable">$max_results</span> <span class="operator">=</span> <span class="number">200</span><span class="operator">;</span>
  <span class="keyword">my</span> <span class="variable">$query</span> <span class="operator">=</span> <span class="variable">CPAN::SQLite::Search</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span><span class="string">db_dir</span> <span class="operator">=&gt;</span> <span class="variable">$db_dir</span><span class="operator">,</span>
                                        <span class="string">db_name</span> <span class="operator">=&gt;</span> <span class="variable">$db_name</span><span class="operator">,</span>
                                        <span class="string">max_results</span> <span class="operator">=&gt;</span> <span class="variable">$max_results</span><span class="operator">);</span>
  <span class="variable">$query</span><span class="operator">-&gt;</span><span class="variable">query</span><span class="operator">(</span><span class="string">mode</span> <span class="operator">=&gt;</span> <span class="string">'module'</span><span class="operator">,</span> <span class="string">name</span> <span class="operator">=&gt;</span> <span class="string">'Net::FTP'</span><span class="operator">);</span>
  <span class="keyword">my</span> <span class="variable">$results</span> <span class="operator">=</span> <span class="variable">$query</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">results</span><span class="operator">}</span><span class="operator">;</span>
</code></pre>

<h1 id="CONSTRUCTING-THE-QUERY">CONSTRUCTING THE QUERY</h1>

<p>This module queries the database via various types of queries and returns the results for subsequent display. The <code>CPAN::SQLite::Search</code> object is created via the <code>new</code> method as</p>

<pre><code>  <span class="keyword">my</span> <span class="variable">$query</span> <span class="operator">=</span> <span class="variable">CPAN::SQLite::Search</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span><span class="string">db_dir</span> <span class="operator">=&gt;</span> <span class="variable">$db_dir</span><span class="operator">,</span>
                                        <span class="string">db_name</span> <span class="operator">=&gt;</span> <span class="variable">$db_name</span><span class="operator">,</span>
                                        <span class="string">max_results</span> <span class="operator">=&gt;</span> <span class="variable">$max_results</span><span class="operator">);</span>
</code></pre>

<p>which takes as arguments</p>

<ul>

<li><p>db_dir =&gt; $db_dir</p>

<p>This is the directory where the database file is stored. This is optional if the <code>CPAN</code> option is given.</p>

</li>
<li><p>CPAN =&gt; $CPAN</p>

<p>This option specifies the <code>cpan_home</code> directory of an already configured CPAN.pm, which is where the database file will be stored if <code>db_dir</code> is not given.</p>

</li>
<li><p>max_results =&gt; $max_results</p>

<p>This is the maximum value used to limit the number of results returned under a user query. If not specified, a value contained within <code>CPAN::SQLite::Search</code> will be used.</p>

</li>
</ul>

<p>A basic query then is constructed as</p>

<pre><code>   <span class="variable">$query</span><span class="operator">-&gt;</span><span class="variable">query</span><span class="operator">(</span><span class="string">mode</span> <span class="operator">=&gt;</span> <span class="variable">$mode</span><span class="operator">,</span> <span class="variable">$type</span> <span class="operator">=&gt;</span> <span class="variable">$value</span><span class="operator">);</span>
</code></pre>

<p>with the results available as</p>

<pre><code>   <span class="keyword">my</span> <span class="variable">$results</span> <span class="operator">=</span> <span class="variable">$query</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">results</span><span class="operator">}</span>
</code></pre>

<p>There are three basic modes:</p>

<ul>

<li><p>module</p>

<p>This is for information on modules.</p>

</li>
<li><p>dist</p>

<p>This is for information on distributions.</p>

</li>
<li><p>author</p>

<p>This is for information on CPAN authors or cpanids.</p>

</li>
</ul>

<h2 id="module-dist-and-author-modes"><code>module</code>, <code>dist</code>, and <code>author</code> modes</h2>

<p>For a mode of <code>module</code>, <code>dist</code>, and <code>author</code>, there are four basic options to be used for the <code>$type =&gt; $value</code> option:</p>

<ul>

<li><p>query =&gt; $query_term</p>

<p>This will search through module names, distribution names, or CPAN author names and ids (for <code>module</code>, <code>dist</code>, and <code>author</code> modes respectively). The results are case insensitive, and Perl regular expressions for the <code>$query_term</code> are recognized.</p>

</li>
<li><p>name =&gt; $name</p>

<p>This will report exact matches (in a case sensitive manner) for the module name, distribution name, or CPAN author id, for <code>module</code>, <code>dist</code>, and <code>author</code> modes respectively.</p>

</li>
<li><p>id =&gt; $id</p>

<p>This will look up information on the primary key according to the mode specified. This is more for internal use, to help speed up queries; using this &quot;publically&quot; is probably not a good idea, as the ids may change over the course of time.</p>

</li>
</ul>

<h1 id="RESULTS">RESULTS</h1>

<p>After making the query, the results can be accessed through</p>

<pre><code>  <span class="keyword">my</span> <span class="variable">$results</span> <span class="operator">=</span> <span class="variable">$query</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">results</span><span class="operator">}</span><span class="operator">;</span>
</code></pre>

<p>No results either can mean no matches were found, or else an error in making the query resulted (in which case, a brief error message is contained in <code><span class="variable">$query</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">error</span><span class="operator">}</span>
</code>). Assuming there are results, what is returned depends on the mode and on the type of query. See <a href="../../../../cpan/build/CPAN-SQLite-0.202-YFPAex/blib/lib/CPAN/SQLite/Populate.html">CPAN::SQLite::Populate</a> for a description of the fields in the various tables listed below - these fields are used as the keys of the hash references that arise.</p>

<h2 id="author-mode"><code>author</code> mode</h2>

<ul>

<li><p><code>name</code> or <code>id</code> query</p>

<p>This returns the <code>auth_id</code>, <code>cpanid</code>, <code>email</code>, and <code>fullname</code> of the <code>auths</code> table. As well, an array reference <code><span class="variable">$results</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">dists</span><span class="operator">}</span>
</code> is returned representing all distributions associated with that <code>cpanid</code> - each member of the array reference is a hash reference describing the <code>dist_id</code>, <code>dist_name</code>, <code>dist_abs</code>, <code>dist_vers</code>, and <code>dist_file</code> fields in the <code>dists</code> table. An additional entry, <code>download</code>, is supplied, which can be used as <code>$CPAN/authors/id/$download</code> to specify the url of the distribution.</p>

</li>
<li><p><code>query</code> query</p>

<p>If this results in more than one match, an array reference is returned, each member of which is a hash reference containg the <code>auth_id</code>, <code>cpanid</code>, and <code>fullname</code> fields. If there is only one result found, a <code>name</code> query based on the matched <code>cpanid</code> is performed.</p>

</li>
</ul>

<h2 id="module-mode"><code>module</code> mode</h2>

<ul>

<li><p><code>name</code> or <code>id</code> query</p>

<p>This returns the <code>mod_id</code>, <code>mod_name</code>, <code>mod_abs</code>, <code>mod_vers</code>, <code>dslip</code>, <code>chapterid</code>, <code>dist_id</code>, <code>dist_name</code>, <code>dist_file</code>, <code>auth_id</code>, <code>cpanid</code>, <code>fullname</code>, and <code>email</code> of the <code>auths</code>, <code>mods</code>, and <code>dists</code> tables. As well, the following entries may be present.</p>

<ul>

<li><p><code>download</code></p>

<p>This can be used as <code>$CPAN/authors/id/$download</code> to specify the url of the distribution.</p>

</li>
<li><p><code>dslip_info</code></p>

<p>If <code>dslip</code> is available, an array reference <code>dslip_info</code> is supplied, each entry being a hash reference. The hash reference contains two keys - <code>desc</code>, whose value is a general description of the what the dslip entry represents, and <code>what</code>, whose value is a description of the entry itself.</p>

</li>
</ul>

</li>
<li><p><code>query</code> query</p>

<p>If this results in more than one match, an array reference is returned, each member of which is a hash reference containing the <code>mod_id</code>, <code>mod_name</code>, <code>mod_abs</code>, <code>mod_abs</code>, <code>dist_vers</code>, <code>dist_abs</code>, <code>auth_id</code>, <code>cpanid</code>, <code>dist_id</code>, <code>dist_name</code>, and <code>dist_file</code>. As well, a <code>download</code> field which can be used as <code>$CPAN/authors/id/$download</code> to specify the url of the distribution is provided. If there is only one result found, a <code>name</code> query based on the matched <code>mod_name</code> is performed.</p>

</li>
</ul>

<h2 id="dist-mode"><code>dist</code> mode</h2>

<ul>

<li><p><code>name</code> or <code>id</code> query</p>

<p>This returns the <code>dist_id</code>, <code>dist_name</code>, <code>dist_abs</code>, <code>dist_vers</code>, <code>dist_file</code>, <code>size</code>, <code>birth</code>, <code>auth_id</code>, <code>cpanid</code>, and <code>fullname</code> of the <code>auths</code>, <code>mods</code>, and <code>dists</code> tables. As well, the following entries may be present.</p>

<ul>

<li><p><code>download</code></p>

<p>This can be used as <code>$CPAN/authors/id/$download</code> to specify the url of the distribution.</p>

</li>
<li><p><code>mods</code></p>

<p>This is an array reference containing information on the modules present. Each entry is a hash reference containing the <code>mod_id</code>, <code>mod_name</code>, <code>mod_abs</code>, <code>mod_vers</code>, and <code>dslip</code> fields for the module.</p>

</li>
<li><p><code>dslip</code> and <code>dslip_info</code></p>

<p>If the module name and distribution name are related by <code>s/::/-</code>, the <code>dslip</code> and <code>dslip_info</code> entries for that module are returned.</p>

</li>
</ul>

</li>
<li><p><code>query</code> query</p>

<p>If this results in more than one match, an array reference is returned, each member of which is a hash reference containing the <code>dist_id</code>, <code>dist_name</code>, <code>dist_abs</code>, <code>dist_file</code>, and <code>cpanid</code> fields. As well, a <code>download</code> field which can be used as <code>$CPAN/authors/id/$download</code> to specify the url of the distribution is provided. If there is only one result found, a <code>name</code> query based on the matched <code>dist_name</code> is performed.</p>

</li>
</ul>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p><a href="../../../../cpan/build/CPAN-SQLite-0.202-YFPAex/blib/lib/CPAN/SQLite/Populate.html">CPAN::SQLite::Populate</a>.</p>

<h1 id="AUTHORS">AUTHORS</h1>

<p>Randy Kobes (passed away on September 18, 2010)</p>

<p>Serguei Trouchelle &lt;stro@cpan.org&gt;</p>

<h1 id="COPYRIGHT">COPYRIGHT</h1>

<p>Copyright 2006,2008 by Randy Kobes &lt;r.kobes@uwinnipeg.ca&gt;.</p>

<p>Copyright 2011 by Serguei Trouchelle &lt;stro@cpan.org&gt;.</p>

<p>Use and redistribution are under the same terms as Perl itself.</p>


</body>

</html>


